#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Created on Wed Mar 31 23:58:30 2021

@author: harshittrehan
"""

import glob

def fileLen(fileName):
    with open(fileName, "r") as rf:
        for i,l in enumerate(rf):
            pass
        if i+1 >= 1200:
            return True
        else:
            return False

filesWin = glob.glob("../DATA/Malicia (.txt Opcodes)/winwebsec/*.txt")
filesZbot = glob.glob("../DATA/Malicia (.txt Opcodes)/zbot/*.txt")
filesZacc = glob.glob("../DATA/Malicia (.txt Opcodes)/zeroaccess/*.txt")

winCount, zbotCount, zaccCount = 0, 0, 0

for file in filesWin:
    if fileLen(file):
        winCount += 1

for file in filesZbot:
    if fileLen(file):
        zbotCount += 1
        
for file in filesZacc:
    if fileLen(file):
        zaccCount += 1

print(winCount, zbotCount, zaccCount)
'''
files = glob.glob("../DATA/Malicia (.txt Opcodes)/winwebsec/*.txt")

s = set()   
ts = set()
count = 0

flag = False
fileNum = 1

minVal = set()
for file in files:
    with open(file, "r") as f:
        for i, l in enumerate(f):
            pass
        if i+1 < 1200:
            minVal.add(file)

fileszbot = glob.glob("../DATA/Malicia (.txt Opcodes)/zbot/*.txt")
minValzbot = set()
for file in fileszbot:
    with open(file, "r") as f:
        for i, l in enumerate(f):
            pass
        if i+1 < 1200:
            minValzbot.add(file)

with open("obseqZB.txt", "w") as wf:
    for file in fileszbot:
        if file in minValzbot:
            print('Small file:' + file)
            continue
        
        if count<30000:
            with open(file, "r") as f:
                for line in f:
                    if count<30000:
                        wf.write(line)
                        count += 1
                    else:
                        break
                    
        elif fileNum<=100:
            if not flag:
                print("---")
                flag = True
                continue
            else:
                testCount = 0
                with open(file, "r") as f:
                    with open("zbottest/" + str(fileNum) + "zbot.txt", "w") as tf:
                        for line in f:
                            if testCount<1200:
                                tf.write(line)
                                testCount += 1
                            else:
                                testCount = 0
                                fileNum += 1
                                break  
                            
        else:
            break

with open("obseqZB.txt", "r") as f:
    for line in f:
        s.add(line)

fileNum = 1

while fileNum<=100:
    with open("zbottest/" + str(fileNum) + "zbot.txt", "r") as f:
        for line in f:
            ts.add(line)
        fileNum += 1
 
print(s)
print(len(s))
print(ts)
print(len(ts))

for val in ts:
    if val not in s:
        print('missing: ' + val)

with open("opcodesZB.txt", "w") as wf:
    for val in s:
        wf.write(val)

# winwebsec now:

fileNum = 1
for file in files:
    if file in minVal:
        print('Small file:' + file)
        continue
    testCount = 0
    if fileNum<=100:
        with open(file, "r") as f:    
            with open( "wintest/" + str(fileNum) + "winweb.txt" , "w") as wf:
                for line in f:
                    if testCount<1200:
                        wf.write(line)
                        testCount += 1
                    else:
                        testCount = 0
                        fileNum += 1
                        break
    else:
        break

st = set()

fileNum = 1
while fileNum<=100:
    with open("wintest/" + str(fileNum) + "winweb.txt", "r") as f:
        for line in f:
            st.add(line)
        fileNum += 1

print(st)
print(len(st))

for val in st:
    if val not in s:
        print('missing: ' + val)
'''